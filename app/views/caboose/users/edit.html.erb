 
<h1>Edit User</h1>
<div id='user_<%= @edituser.id %>_container'></div>

<% content_for :caboose_js do %>
<%= javascript_include_tag "caboose/model.form.user" %>
<script type="text/javascript">

$(document).ready(function() {
  var user = new Model({
    form: 'Model.Form.User',
    name: 'User',
    id: <%= @edituser.id %>,
    listing_url: 'get /admin/users',
    update_url: 'put /admin/users/<%= @edituser.id %>',
    delete_url: 'delete /admin/users/<%= @edituser.id %>',
    attributes: [
      { name: 'first_name' , type: 'text', value: "<%= @edituser.first_name %>" },
      { name: 'last_name'  , type: 'text', value: "<%= @edituser.last_name  %>" },
      { name: 'username'   , type: 'text', value: "<%= @edituser.username   %>" },
      { name: 'email'      , type: 'text', value: "<%= @edituser.email      %>" },
      { name: 'password'   , type: 'password' },
      {
        name: 'roles', 
        type: 'checkbox-multiple',  
        value: <%= @roles.collect{|r| r.id}.to_json %>, 
        text: "<%= @roles.collect{|r| r.name}.join(', ') %>",
        empty_text: '[No roles]',
        multiple: true,
        loading_message: 'Getting roles...',
        options_url: '/admin/roles/options'
      },
      {
        name: 'pic', 
        type: 'image',  
        value: '',
        update_url: '/admin/users/<%= @edituser.id %>/update-pic'
      }
    ]
  });
});

</script>
<% end %>

<% content_for :caboose_js do %>
<script type='text/javascript'>
if (parent.$.fn.colorbox)
  parent.$.fn.colorbox.resize({ 'innerWidth': 600, 'innerHeight': 400 });
</script>
<% end %>
